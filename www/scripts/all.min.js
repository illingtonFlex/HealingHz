var HealingHz=HealingHz||{};HealingHz.createNS=function(e){var a=e.split("."),n=HealingHz;"HealingHz"===a[0]&&(a=a.slice(1));for(var i=0;i<a.length;i++){var o=a[i];"undefined"==typeof n[o]&&(n[o]={}),n=n[o]}return n},HealingHz.showVictoryText=function(){console.log("FAIL"),$("#victoryDiv").modal("show")},HealingHz.showFailureText=function(){console.log("FAIL"),$("#failureDiv").modal("show")},HealingHz.checkNoteOrder=function(){var e=!0,a=0;for(checki=0;checki<HealingHz.NUM_MARKERS;checki++){if(!HealingHz.markerBoxes[checki].isFull())return!1;var n=HealingHz.markerBoxes[checki].getNote();a<=n.index?a=n.index:e=!1}return e===!0?HealingHz.showVictoryText():HealingHz.showFailureText(),e},HealingHz.initAudio=function(e){console.log("Initializing chord: "+e.name);var a=e.getNotes(),n="audio/"+(Math.floor(4*Math.random())+1)+"/";console.log("audiopath: "+n);for(var i=[],o=0;o<a.length;o++){var r=a[o];i.push({id:r.name,src:r.name+".ogg"})}createjs.Sound.alternateExtensions=["mp3","wav"],createjs.Sound.registerSounds(i,n)},HealingHz.reset=function(){for(mi=0;mi<HealingHz.noteMarkers.length;mi++){var e=HealingHz.noteMarkers[mi],a=e.circle;createjs.Tween.get(a,{loop:!1}).to({alpha:0},50).to({alpha:1},50).to({alpha:0},50).to({alpha:1},50).to({x:a.origx,y:a.origy},1e3,createjs.Ease.getPowInOut(4))}},HealingHz.playSilentSound=function(){createjs.WebAudioPlugin.playEmptySound()},HealingHz.init=function(){var e=document.getElementById("healingHzCanvas");e.addEventListener("touchstart",HealingHz.playSilentSound,!1);var a=HealingHz.model,n=HealingHz.data,o=new createjs.Stage("healingHzCanvas");createjs.Touch.enable(o);var r=new n.ChordFactory,t=r.getChord();HealingHz.NUM_MARKERS=t.getNotes().length,HealingHz.initAudio(t);var l=new a.NoteMarkerFactory;for(HealingHz.noteMarkers=l.buildNoteMarkers(t),HealingHz.markerBoxes=[],i=0;i<HealingHz.noteMarkers.length;i++)HealingHz.noteMarkers[i].draw(o);for(i=0;i<HealingHz.NUM_MARKERS;i++){var H=(690+10*i)/HealingHz.NUM_MARKERS+110*i;HealingHz.markerBoxes.push(new HealingHz.model.NoteMarkerBox(H,50,"white","black")),HealingHz.markerBoxes[i].draw(o)}},window.onload=function(){HealingHz.init()};
var ns=HealingHz.createNS("HealingHz.data");ns.Chord=function(t,n){this.name=t,this.notes=n},ns.Chord.prototype.getName=function(){return this.name},ns.Chord.prototype.getNotes=function(){return this.notes};
var ns=HealingHz.createNS("HealingHz.data");ns.ChordFactory=function(){this.C4=new HealingHz.data.Note("C",0),this.Db4=new HealingHz.data.Note("CsharpDflat",1),this.D4=new HealingHz.data.Note("D",2),this.Eb4=new HealingHz.data.Note("DsharpEflat",3),this.E4=new HealingHz.data.Note("E",4),this.F4=new HealingHz.data.Note("F",5),this.Gb4=new HealingHz.data.Note("FsharpGflat",6),this.G4=new HealingHz.data.Note("G",7),this.Ab4=new HealingHz.data.Note("GsharpAflat",8),this.A4=new HealingHz.data.Note("A",9),this.Bb4=new HealingHz.data.Note("AsharpBflat",10),this.B4=new HealingHz.data.Note("B",11),this.C_major=new HealingHz.data.Chord("C major",[this.C4,this.E4,this.G4]),this.Db_major=new HealingHz.data.Chord("C#/Db major",[this.Db4,this.F4,this.Ab4]),this.D_major=new HealingHz.data.Chord("D major",[this.D4,this.Gb4,this.A4]),this.Eb_major=new HealingHz.data.Chord("D#/Eb major",[this.Eb4,this.G4,this.Bb4]),this.E_major=new HealingHz.data.Chord("E major",[this.E4,this.Ab4,this.B4]),this.F_major=new HealingHz.data.Chord("F major",[this.F4,this.A4,this.C4]),this.Gb_major=new HealingHz.data.Chord("F#/Gb major",[this.Gb4,this.Bb4,this.Db4]),this.G_major=new HealingHz.data.Chord("G major",[this.G4,this.B4,this.D4]),this.Ab_major=new HealingHz.data.Chord("G#/Ab major",[this.Ab4,this.C4,this.Eb4]),this.A_major=new HealingHz.data.Chord("A major",[this.A4,this.Db4,this.E4]),this.Bb_major=new HealingHz.data.Chord("A#/Bb major",[this.Bb4,this.D4,this.F4]),this.B_major=new HealingHz.data.Chord("B major",[this.B4,this.Eb4,this.Gb4]),this.C_major7=new HealingHz.data.Chord("C major7",[this.C4,this.E4,this.G4,this.B4]),this.Db_major7=new HealingHz.data.Chord("C#/Db major7",[this.Db4,this.F4,this.Ab4,this.C4]),this.D_major7=new HealingHz.data.Chord("D major7",[this.D4,this.Gb4,this.A4,this.Bb4]),this.Eb_major7=new HealingHz.data.Chord("D#/Eb major7",[this.Eb4,this.G4,this.Bb4,this.D4]),this.E_major7=new HealingHz.data.Chord("E major7",[this.E4,this.Ab4,this.B4,this.Eb4]),this.F_major7=new HealingHz.data.Chord("F major7",[this.F4,this.A4,this.C4,this.E4]),this.Gb_major7=new HealingHz.data.Chord("F#/Gb major7",[this.Gb4,this.Bb4,this.Db4,this.F4]),this.G_major7=new HealingHz.data.Chord("G major7",[this.G4,this.B4,this.D4,this.Gb4]),this.Ab_major7=new HealingHz.data.Chord("G#/Ab major7",[this.Ab4,this.C4,this.Eb4,this.G4]),this.A_major7=new HealingHz.data.Chord("A major7",[this.A4,this.Db4,this.E4,this.Ab4]),this.Bb_major7=new HealingHz.data.Chord("A#/Bb major7",[this.Bb4,this.D4,this.F4,this.A4]),this.B_major7=new HealingHz.data.Chord("B major7",[this.B4,this.Eb4,this.Gb4,this.Bb4]),this.C_minor=new HealingHz.data.Chord("C minor",[this.C4,this.Eb4,this.G4]),this.Db_minor=new HealingHz.data.Chord("C#/Db minor",[this.Db4,this.E4,this.Ab4]),this.D_minor=new HealingHz.data.Chord("D minor",[this.D4,this.F4,this.A4]),this.Eb_minor=new HealingHz.data.Chord("D#/Eb minor",[this.Eb4,this.Gb4,this.Bb4]),this.E_minor=new HealingHz.data.Chord("E minor",[this.E4,this.G4,this.B4]),this.F_minor=new HealingHz.data.Chord("F minor",[this.F4,this.Ab4,this.C4]),this.Gb_minor=new HealingHz.data.Chord("F#/Gb minor",[this.Gb4,this.A4,this.Db4]),this.G_minor=new HealingHz.data.Chord("G minor",[this.G4,this.Bb4,this.D4]),this.Ab_minor=new HealingHz.data.Chord("G#/Ab minor",[this.Ab4,this.B4,this.Eb4]),this.A_minor=new HealingHz.data.Chord("A minor",[this.A4,this.C4,this.E4]),this.Bb_minor=new HealingHz.data.Chord("A#/Bb minor",[this.Bb4,this.Db4,this.F4]),this.B_minor=new HealingHz.data.Chord("B minor",[this.B4,this.D4,this.Gb4]),this.C_minor7=new HealingHz.data.Chord("C minor7",[this.C4,this.Eb4,this.G4,this.Bb4]),this.Db_minor7=new HealingHz.data.Chord("C#/Db minor7",[this.Db4,this.E4,this.Ab4,this.B4]),this.D_minor7=new HealingHz.data.Chord("D minor7",[this.D4,this.F4,this.A4,this.C4]),this.Eb_minor7=new HealingHz.data.Chord("D#/Eb minor7",[this.Eb4,this.Gb4,this.Bb4,this.Db4]),this.E_minor7=new HealingHz.data.Chord("E minor7",[this.E4,this.G4,this.B4,this.D4]),this.F_minor7=new HealingHz.data.Chord("F minor7",[this.F4,this.Ab4,this.C4,this.Eb4]),this.Gb_minor7=new HealingHz.data.Chord("F#/Gb minor7",[this.Gb4,this.A4,this.Db4,this.E4]),this.G_minor7=new HealingHz.data.Chord("G minor7",[this.G4,this.Bb4,this.D4,this.F4]),this.Ab_minor7=new HealingHz.data.Chord("G#/Ab minor7",[this.Ab4,this.B4,this.Eb4,this.Gb4]),this.A_minor7=new HealingHz.data.Chord("A minor7",[this.A4,this.C4,this.E4,this.G4]),this.Bb_minor7=new HealingHz.data.Chord("A#/Bb minor7",[this.Bb4,this.Db4,this.F4,this.Ab4]),this.B_minor7=new HealingHz.data.Chord("B minor7",[this.B4,this.D4,this.Gb4,this.A4]),this.C_chrom=new HealingHz.data.Chord("C Chromatic scale",[this.C4,this.Db4,this.D4,this.Eb4,this.E4]),this.Db_chrom=new HealingHz.data.Chord("C#/Db Chromatic scale",[this.Db4,this.D4,this.Eb4,this.E4,this.F4]),this.D_chrom=new HealingHz.data.Chord("D Chromatic scale",[this.D4,this.Eb4,this.E4,this.F4,this.Gb4]),this.Eb_chrom=new HealingHz.data.Chord("D#/Eb Chromatic scale",[this.Eb4,this.E4,this.F4,this.Gb4,this.G4]),this.E_chrom=new HealingHz.data.Chord("E Chromatic scale",[this.E4,this.F4,this.Gb4,this.G4,this.Ab4]),this.F_chrom=new HealingHz.data.Chord("F Chromatic scale",[this.F4,this.Gb4,this.G4,this.Ab4,this.A4]),this.Gb_chrom=new HealingHz.data.Chord("F#/Gb Chromatic scale",[this.Gb4,this.G4,this.Ab4,this.A4,this.Bb4]),this.G_chrom=new HealingHz.data.Chord("G Chromatic scale",[this.G4,this.Ab4,this.A4,this.Bb4,this.B4]),this.chords=[this.C_major,this.Db_major,this.D_major,this.Eb_major,this.E_major,this.F_major,this.Gb_major,this.G_major,this.Ab_major,this.A_major,this.Bb_major,this.B_major,this.C_major7,this.Db_major7,this.D_major7,this.Eb_major7,this.E_major7,this.F_major7,this.Gb_major7,this.G_major7,this.Ab_major7,this.A_major7,this.Bb_major7,this.B_major7,this.C_minor,this.Db_minor,this.D_minor,this.Eb_minor,this.E_minor,this.F_minor,this.Gb_minor,this.G_minor,this.Ab_minor,this.A_minor,this.Bb_minor,this.B_minor,this.C_minor7,this.Db_minor7,this.D_minor7,this.Eb_minor7,this.E_minor7,this.F_minor7,this.Gb_minor7,this.G_minor7,this.Ab_minor7,this.A_minor7,this.Bb_minor7,this.B_minor7,this.C_chrom,this.Db_chrom,this.D_chrom,this.Eb_chrom,this.E_chrom,this.F_chrom,this.Gb_chrom,this.G_chrom]},ns.ChordFactory.prototype.getChord=function(){return this.chords[Math.floor(Math.random()*this.chords.length)]};
var ns=HealingHz.createNS("HealingHz.data");ns.Note=function(n,a){this.name=n,this.index=a};
var ns=HealingHz.createNS("HealingHz.model");ns.NoteMarker=function(e,t,r,a,o,i){this.circle=new createjs.Shape,this.circle.origx=e,this.circle.origy=t,this.circle.x=e,this.circle.y=t,this.circle.rad=r,this.circle.color=a,this.circle.borderColor=o,this.note=i},ns.NoteMarker.prototype.draw=function(e){var t=this.circle,r=this.note;t.graphics.beginStroke(t.borderColor).beginFill(t.color).drawCircle(0,0,t.rad),t.on("pressmove",function(t){createjs.Tween.hasActiveTweens()||(t.target.x=t.stageX,t.target.y=t.stageY,e.update())}),t.on("pressup",function(a){var o=0,s=0;for(createjs.Sound.play(r.name),console.log(r.name),boxi=0;boxi<HealingHz.markerBoxes.length;boxi++){var c=HealingHz.markerBoxes[boxi],l=a.target.localToLocal(0,0,c.box);c.box.hitTest(l.x,l.y)&&(o++,c.hasTooManyNoteMarkers()?createjs.Tween.get(t,{loop:!1}).to({alpha:0},50).to({alpha:1},50).to({alpha:0},50).to({alpha:1},50).to({x:a.target.origx,y:a.target.origy},1e3,createjs.Ease.getPowInOut(4)):(a.target.x=c.box.x+c.w/2,a.target.y=c.box.y+c.h/2)),c.isFull()&&s++}for(0===o&&createjs.Tween.get(t,{loop:!1}).to({x:a.target.origx,y:a.target.origy},1e3,createjs.Ease.getPowInOut(4)),createjs.Tween.get(t,{loop:!1}).to({alpha:0},250).to({alpha:1},500),createjs.Ticker.setFPS(60),createjs.Ticker.addEventListener("tick",e),s==HealingHz.markerBoxes.length&&HealingHz.checkNoteOrder(),i=0;i<HealingHz.noteMarkers.length;i++){HealingHz.noteMarkers[i]}}),e.addChild(t)};
var ns=HealingHz.createNS("HealingHz.model");ns.NoteMarkerBox=function(o,e,t,r){this.box=new createjs.Shape,this.box.x=o,this.box.y=e,this.w=100,this.h=100,this.color=t,this.borderColor=r},ns.NoteMarkerBox.prototype.draw=function(o){var e=this.box;e.graphics.beginStroke(this.borderColor).beginFill(this.color).drawRect(0,0,this.w,this.h),o.addChildAt(e,0),o.update()},ns.NoteMarkerBox.prototype.hasTooManyNoteMarkers=function(){var o=0;for(i=0;i<HealingHz.noteMarkers.length;i++){var e=HealingHz.noteMarkers[i].circle.localToLocal(0,0,this.box);this.box.hitTest(e.x,e.y)&&o++}return o>1},ns.NoteMarkerBox.prototype.isFull=function(){var o=0;for(i=0;i<HealingHz.noteMarkers.length;i++){var e=HealingHz.noteMarkers[i].circle.localToLocal(0,0,this.box);this.box.hitTest(e.x,e.y)&&o++}return o>0},ns.NoteMarkerBox.prototype.getNote=function(){var o;for(i=0;i<HealingHz.noteMarkers.length;i++){var e=HealingHz.noteMarkers[i].circle.localToLocal(0,0,this.box);this.box.hitTest(e.x,e.y)&&(o=HealingHz.noteMarkers[i].note)}return o};
var ns=HealingHz.createNS("HealingHz.model");ns.NoteMarkerFactory=function(){},ns.NoteMarkerFactory.prototype.generateColorCode=function(){return Math.floor(16777215*Math.random())},ns.NoteMarkerFactory.prototype.randomizeNotes=function(r){for(var e=r.length-1;e>0;e--){var o=Math.floor(Math.random()*(e+1)),t=r[e];r[e]=r[o],r[o]=t}return r},ns.NoteMarkerFactory.prototype.buildNoteMarkers=function(r){var e=[],o=r.getNotes();for(this.randomizeNotes(o),i=0;i<o.length;i++){var t=this.generateColorCode(),a=(690+10*i)/HealingHz.NUM_MARKERS+110*i+50,n=new HealingHz.model.NoteMarker(a,200,40,"#"+t.toString(16),"black",o[i]);e.push(n)}return e};