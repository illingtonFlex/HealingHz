var HealingHz=HealingHz||{};HealingHz.createNS=function(e){var n=e.split("."),a=HealingHz;"HealingHz"===n[0]&&(n=n.slice(1));for(var t=0;t<n.length;t++){var r=n[t];"undefined"==typeof a[r]&&(a[r]={}),a=a[r]}return a},HealingHz.stage=null,HealingHz.testPlanResults={notesPresented:[],notesSubmitted:[],voice:null},HealingHz.SETTINGS={mode:"standalone",testPlanIterator:0,currentTestPlan:null,currentVoice:0},HealingHz.postResults=function(e){console.log(e)},HealingHz.handleCorrectAnswer=function(){"testplan"!=HealingHz.SETTINGS.mode?$("#victoryDiv").modal("show"):HealingHz.processSubmission()},HealingHz.handleInorrectAnswer=function(){"testplan"!=HealingHz.SETTINGS.mode?$("#failureDiv").modal("show"):HealingHz.processSubmission()},HealingHz.processSubmission=function(){for(var e=[],n=0;n<HealingHz.noteMarkers.length;n++)e.push(HealingHz.noteMarkers[n].note);for(HealingHz.testPlanResults.notesPresented.push(e),HealingHz.testPlanResults.voice=HealingHz.SETTINGS.currentVoice,HealingHz.postResults(HealingHz.testPlanResults),n=0;n<HealingHz.noteMarkers.length;n++)HealingHz.stage.removeChild(HealingHz.noteMarkers[n].circle),HealingHz.stage.removeChild(HealingHz.markerBoxes[n].box);if(HealingHz.SETTINGS.testPlanIterator++,HealingHz.SETTINGS.testPlanIterator<HealingHz.SETTINGS.currentTestPlan.chords.length){var a=HealingHz.getCurrentChord();HealingHz.init(a,HealingHz.SETTINGS.currentVoice)}else{var t=document.querySelector('[ng-app="HealingHz-CurriculumUI"]'),r=angular.element(t).scope();r.$apply(function(){r.results=HealingHz.testPlanResults}),$("#resultsDiv").modal("show")}},HealingHz.getCurrentChord=function(){var e=(new HealingHz.data.ChordFactory).getChord(HealingHz.SETTINGS.currentTestPlan.chords[HealingHz.SETTINGS.testPlanIterator].name);return e},HealingHz.checkNoteOrder=function(){for(var e=!0,n=0,a=[],t=0;t<HealingHz.markerBoxes.length;t++){if(!HealingHz.markerBoxes[t].isFull())return!1;var r=HealingHz.markerBoxes[t].getNote();a.push(r),n<=r.index?n=r.index:e=!1}return HealingHz.testPlanResults.notesSubmitted.push(a),e===!0?HealingHz.handleCorrectAnswer():HealingHz.handleInorrectAnswer(),e},HealingHz.initAudio=function(e,n){for(var a=e.getNotes(),t="audio/"+n+"/",r=[],i=0;i<a.length;i++){var l=a[i];r.push({id:l.fileName,src:l.fileName+".ogg"})}createjs.Sound.alternateExtensions=["mp3","wav"],createjs.Sound.registerSounds(r,t),createjs.Sound.registerSound("audio/1/C.ogg","voice1"),createjs.Sound.registerSound("audio/2/C.ogg","voice2"),createjs.Sound.registerSound("audio/3/C.ogg","voice3"),createjs.Sound.registerSound("audio/4/C.ogg","voice4")},HealingHz.playVoice=function(e){createjs.Sound.play("voice"+e)},HealingHz.reset=function(){for(mi=0;mi<HealingHz.noteMarkers.length;mi++){var e=HealingHz.noteMarkers[mi],n=e.circle;createjs.Tween.get(n,{loop:!1}).to({alpha:0},50).to({alpha:1},50).to({alpha:0},50).to({alpha:1},50).to({x:n.origx,y:n.origy},1e3,createjs.Ease.getPowInOut(4))}},HealingHz.playSilentSound=function(){createjs.WebAudioPlugin.playEmptySound()},HealingHz.initStandalone=function(){var e=(new HealingHz.data.ChordFactory).getChord(),n=Math.floor(4*Math.random())+1;HealingHz.init(e,n)},HealingHz.initTestPlan=function(e,n){"0"===n&&(n=Math.floor(4*Math.random())+1);var a=(new HealingHz.data.ChordFactory).getChord(e.chords[HealingHz.SETTINGS.testPlanIterator].name);HealingHz.init(a,n),HealingHz.SETTINGS.mode="testplan",HealingHz.SETTINGS.currentTestPlan=e,HealingHz.SETTINGS.currentVoice=n},HealingHz.init=function(e,n){var a=document.getElementById("healingHzCanvas");a.addEventListener("touchstart",HealingHz.playSilentSound,!1);var t=HealingHz.model;null===HealingHz.stage&&(HealingHz.stage=new createjs.Stage("healingHzCanvas"),createjs.Touch.enable(HealingHz.stage)),HealingHz.initAudio(e,n),HealingHz.noteMarkers=(new t.NoteMarkerFactory).buildNoteMarkers(e),HealingHz.markerBoxes=[];for(var r=0;r<HealingHz.noteMarkers.length;r++)HealingHz.noteMarkers[r].draw(HealingHz.stage);for(r=0;r<e.getNotes().length;r++){var i=(690+10*r)/e.getNotes().length+110*r;HealingHz.markerBoxes.push(new HealingHz.model.NoteMarkerBox(i,50,"white","black")),HealingHz.markerBoxes[r].draw(HealingHz.stage)}},window.onload=function(){if(location.search){for(var e={},n=location.search.substring(1).split("&"),a=0;a<n.length;a++){var t=n[a].split("=");t[0]&&(e[t[0]]=t[1]||!0)}$.getJSON("curriculums.json",function(n){for(var a=0;a<n.length;a++)n[a].id===e.c&&(HealingHz.SETTINGS.currentVoice=e.v,HealingHz.SETTINGS.currentTestPlan=n[a],HealingHz.initTestPlan(n[a],e.v))})}else HealingHz.initStandalone()};
var ns=HealingHz.createNS("HealingHz.model");ns.NoteMarker=function(e,t,r,a,o,i){this.circle=new createjs.Shape,this.circle.origx=e,this.circle.origy=t,this.circle.x=e,this.circle.y=t,this.circle.rad=r,this.circle.color=a,this.circle.borderColor=o,this.note=i},ns.NoteMarker.prototype.draw=function(e){var t=this.circle,r=this.note;t.graphics.beginStroke(t.borderColor).beginFill(t.color).drawCircle(0,0,t.rad),t.on("pressmove",function(t){createjs.Tween.hasActiveTweens()||(t.target.x=t.stageX,t.target.y=t.stageY,e.update())}),t.on("pressup",function(a){var o=0,l=0;for(console.log(r.fileName),createjs.Sound.play(r.fileName),boxi=0;boxi<HealingHz.markerBoxes.length;boxi++){var s=HealingHz.markerBoxes[boxi],c=a.target.localToLocal(0,0,s.box);s.box.hitTest(c.x,c.y)&&(o++,s.hasTooManyNoteMarkers()?createjs.Tween.get(t,{loop:!1}).to({alpha:0},50).to({alpha:1},50).to({alpha:0},50).to({alpha:1},50).to({x:a.target.origx,y:a.target.origy},1e3,createjs.Ease.getPowInOut(4)):(a.target.x=s.box.x+s.w/2,a.target.y=s.box.y+s.h/2)),s.isFull()&&l++}for(0===o&&createjs.Tween.get(t,{loop:!1}).to({x:a.target.origx,y:a.target.origy},1e3,createjs.Ease.getPowInOut(4)),createjs.Tween.get(t,{loop:!1}).to({alpha:0},250).to({alpha:1},500),createjs.Ticker.setFPS(60),createjs.Ticker.addEventListener("tick",e),l==HealingHz.markerBoxes.length&&HealingHz.checkNoteOrder(),i=0;i<HealingHz.noteMarkers.length;i++){HealingHz.noteMarkers[i]}}),e.addChild(t)};
var ns=HealingHz.createNS("HealingHz.model");ns.NoteMarkerBox=function(o,e,t,r){this.box=new createjs.Shape,this.box.x=o,this.box.y=e,this.w=100,this.h=100,this.color=t,this.borderColor=r},ns.NoteMarkerBox.prototype.draw=function(o){var e=this.box;e.graphics.beginStroke(this.borderColor).beginFill(this.color).drawRect(0,0,this.w,this.h),o.addChildAt(e,0),o.update()},ns.NoteMarkerBox.prototype.hasTooManyNoteMarkers=function(){var o=0;for(i=0;i<HealingHz.noteMarkers.length;i++){var e=HealingHz.noteMarkers[i].circle.localToLocal(0,0,this.box);this.box.hitTest(e.x,e.y)&&o++}return o>1},ns.NoteMarkerBox.prototype.isFull=function(){var o=0;for(i=0;i<HealingHz.noteMarkers.length;i++){var e=HealingHz.noteMarkers[i].circle.localToLocal(0,0,this.box);this.box.hitTest(e.x,e.y)&&o++}return o>0},ns.NoteMarkerBox.prototype.getNote=function(){var o;for(i=0;i<HealingHz.noteMarkers.length;i++){var e=HealingHz.noteMarkers[i].circle.localToLocal(0,0,this.box);this.box.hitTest(e.x,e.y)&&(o=HealingHz.noteMarkers[i].note)}return o};
var ns=HealingHz.createNS("HealingHz.model");ns.NoteMarkerFactory=function(){},ns.NoteMarkerFactory.prototype.generateColorCode=function(){return Math.floor(16777215*Math.random())},ns.NoteMarkerFactory.prototype.randomizeNotes=function(e){for(var r=e.length-1;r>0;r--){var o=Math.floor(Math.random()*(r+1)),t=e[r];e[r]=e[o],e[o]=t}return e},ns.NoteMarkerFactory.prototype.buildNoteMarkers=function(e){var r=[],o=e.getNotes();for(this.randomizeNotes(o),i=0;i<o.length;i++){var t=this.generateColorCode(),n=(690+10*i)/e.notes.length+110*i+50,a=new HealingHz.model.NoteMarker(n,200,40,"#"+t.toString(16),"black",o[i]);r.push(a)}return r};
var ns=HealingHz.createNS("HealingHz.data");ns.Chord=function(t,n){this.name=t,this.notes=n},ns.Chord.prototype.getName=function(){return this.name},ns.Chord.prototype.getNotes=function(){return this.notes};
var ns=HealingHz.createNS("HealingHz.data");ns.ChordFactory=function(){this.C4=new HealingHz.data.Note("C","C",0),this.Db4=new HealingHz.data.Note("CsharpDflat","C#/Db",1),this.D4=new HealingHz.data.Note("D","D",2),this.Eb4=new HealingHz.data.Note("DsharpEflat","D#/Eb",3),this.E4=new HealingHz.data.Note("E","E",4),this.F4=new HealingHz.data.Note("F","F",5),this.Gb4=new HealingHz.data.Note("FsharpGflat","F#/Gb",6),this.G4=new HealingHz.data.Note("G","G",7),this.Ab4=new HealingHz.data.Note("GsharpAflat","G#/Ab",8),this.A4=new HealingHz.data.Note("A","A",9),this.Bb4=new HealingHz.data.Note("AsharpBflat","A#Bb",10),this.B4=new HealingHz.data.Note("B","B",11),this.C_major=new HealingHz.data.Chord("C major",[this.C4,this.E4,this.G4]),this.Db_major=new HealingHz.data.Chord("C#/Db major",[this.Db4,this.F4,this.Ab4]),this.D_major=new HealingHz.data.Chord("D major",[this.D4,this.Gb4,this.A4]),this.Eb_major=new HealingHz.data.Chord("D#/Eb major",[this.Eb4,this.G4,this.Bb4]),this.E_major=new HealingHz.data.Chord("E major",[this.E4,this.Ab4,this.B4]),this.F_major=new HealingHz.data.Chord("F major",[this.F4,this.A4,this.C4]),this.Gb_major=new HealingHz.data.Chord("F#/Gb major",[this.Gb4,this.Bb4,this.Db4]),this.G_major=new HealingHz.data.Chord("G major",[this.G4,this.B4,this.D4]),this.Ab_major=new HealingHz.data.Chord("G#/Ab major",[this.Ab4,this.C4,this.Eb4]),this.A_major=new HealingHz.data.Chord("A major",[this.A4,this.Db4,this.E4]),this.Bb_major=new HealingHz.data.Chord("A#/Bb major",[this.Bb4,this.D4,this.F4]),this.B_major=new HealingHz.data.Chord("B major",[this.B4,this.Eb4,this.Gb4]),this.C_major7=new HealingHz.data.Chord("C major7",[this.C4,this.E4,this.G4,this.B4]),this.Db_major7=new HealingHz.data.Chord("C#/Db major7",[this.Db4,this.F4,this.Ab4,this.C4]),this.D_major7=new HealingHz.data.Chord("D major7",[this.D4,this.Gb4,this.A4,this.Bb4]),this.Eb_major7=new HealingHz.data.Chord("D#/Eb major7",[this.Eb4,this.G4,this.Bb4,this.D4]),this.E_major7=new HealingHz.data.Chord("E major7",[this.E4,this.Ab4,this.B4,this.Eb4]),this.F_major7=new HealingHz.data.Chord("F major7",[this.F4,this.A4,this.C4,this.E4]),this.Gb_major7=new HealingHz.data.Chord("F#/Gb major7",[this.Gb4,this.Bb4,this.Db4,this.F4]),this.G_major7=new HealingHz.data.Chord("G major7",[this.G4,this.B4,this.D4,this.Gb4]),this.Ab_major7=new HealingHz.data.Chord("G#/Ab major7",[this.Ab4,this.C4,this.Eb4,this.G4]),this.A_major7=new HealingHz.data.Chord("A major7",[this.A4,this.Db4,this.E4,this.Ab4]),this.Bb_major7=new HealingHz.data.Chord("A#/Bb major7",[this.Bb4,this.D4,this.F4,this.A4]),this.B_major7=new HealingHz.data.Chord("B major7",[this.B4,this.Eb4,this.Gb4,this.Bb4]),this.C_minor=new HealingHz.data.Chord("C minor",[this.C4,this.Eb4,this.G4]),this.Db_minor=new HealingHz.data.Chord("C#/Db minor",[this.Db4,this.E4,this.Ab4]),this.D_minor=new HealingHz.data.Chord("D minor",[this.D4,this.F4,this.A4]),this.Eb_minor=new HealingHz.data.Chord("D#/Eb minor",[this.Eb4,this.Gb4,this.Bb4]),this.E_minor=new HealingHz.data.Chord("E minor",[this.E4,this.G4,this.B4]),this.F_minor=new HealingHz.data.Chord("F minor",[this.F4,this.Ab4,this.C4]),this.Gb_minor=new HealingHz.data.Chord("F#/Gb minor",[this.Gb4,this.A4,this.Db4]),this.G_minor=new HealingHz.data.Chord("G minor",[this.G4,this.Bb4,this.D4]),this.Ab_minor=new HealingHz.data.Chord("G#/Ab minor",[this.Ab4,this.B4,this.Eb4]),this.A_minor=new HealingHz.data.Chord("A minor",[this.A4,this.C4,this.E4]),this.Bb_minor=new HealingHz.data.Chord("A#/Bb minor",[this.Bb4,this.Db4,this.F4]),this.B_minor=new HealingHz.data.Chord("B minor",[this.B4,this.D4,this.Gb4]),this.C_minor7=new HealingHz.data.Chord("C minor7",[this.C4,this.Eb4,this.G4,this.Bb4]),this.Db_minor7=new HealingHz.data.Chord("C#/Db minor7",[this.Db4,this.E4,this.Ab4,this.B4]),this.D_minor7=new HealingHz.data.Chord("D minor7",[this.D4,this.F4,this.A4,this.C4]),this.Eb_minor7=new HealingHz.data.Chord("D#/Eb minor7",[this.Eb4,this.Gb4,this.Bb4,this.Db4]),this.E_minor7=new HealingHz.data.Chord("E minor7",[this.E4,this.G4,this.B4,this.D4]),this.F_minor7=new HealingHz.data.Chord("F minor7",[this.F4,this.Ab4,this.C4,this.Eb4]),this.Gb_minor7=new HealingHz.data.Chord("F#/Gb minor7",[this.Gb4,this.A4,this.Db4,this.E4]),this.G_minor7=new HealingHz.data.Chord("G minor7",[this.G4,this.Bb4,this.D4,this.F4]),this.Ab_minor7=new HealingHz.data.Chord("G#/Ab minor7",[this.Ab4,this.B4,this.Eb4,this.Gb4]),this.A_minor7=new HealingHz.data.Chord("A minor7",[this.A4,this.C4,this.E4,this.G4]),this.Bb_minor7=new HealingHz.data.Chord("A#/Bb minor7",[this.Bb4,this.Db4,this.F4,this.Ab4]),this.B_minor7=new HealingHz.data.Chord("B minor7",[this.B4,this.D4,this.Gb4,this.A4]),this.C_chrom=new HealingHz.data.Chord("C Chromatic scale",[this.C4,this.Db4,this.D4,this.Eb4,this.E4]),this.Db_chrom=new HealingHz.data.Chord("C#/Db Chromatic scale",[this.Db4,this.D4,this.Eb4,this.E4,this.F4]),this.D_chrom=new HealingHz.data.Chord("D Chromatic scale",[this.D4,this.Eb4,this.E4,this.F4,this.Gb4]),this.Eb_chrom=new HealingHz.data.Chord("D#/Eb Chromatic scale",[this.Eb4,this.E4,this.F4,this.Gb4,this.G4]),this.E_chrom=new HealingHz.data.Chord("E Chromatic scale",[this.E4,this.F4,this.Gb4,this.G4,this.Ab4]),this.F_chrom=new HealingHz.data.Chord("F Chromatic scale",[this.F4,this.Gb4,this.G4,this.Ab4,this.A4]),this.Gb_chrom=new HealingHz.data.Chord("F#/Gb Chromatic scale",[this.Gb4,this.G4,this.Ab4,this.A4,this.Bb4]),this.G_chrom=new HealingHz.data.Chord("G Chromatic scale",[this.G4,this.Ab4,this.A4,this.Bb4,this.B4]),this.chords=[this.C_major,this.Db_major,this.D_major,this.Eb_major,this.E_major,this.F_major,this.Gb_major,this.G_major,this.Ab_major,this.A_major,this.Bb_major,this.B_major,this.C_major7,this.Db_major7,this.D_major7,this.Eb_major7,this.E_major7,this.F_major7,this.Gb_major7,this.G_major7,this.Ab_major7,this.A_major7,this.Bb_major7,this.B_major7,this.C_minor,this.Db_minor,this.D_minor,this.Eb_minor,this.E_minor,this.F_minor,this.Gb_minor,this.G_minor,this.Ab_minor,this.A_minor,this.Bb_minor,this.B_minor,this.C_minor7,this.Db_minor7,this.D_minor7,this.Eb_minor7,this.E_minor7,this.F_minor7,this.Gb_minor7,this.G_minor7,this.Ab_minor7,this.A_minor7,this.Bb_minor7,this.B_minor7,this.C_chrom,this.Db_chrom,this.D_chrom,this.Eb_chrom,this.E_chrom,this.F_chrom,this.Gb_chrom,this.G_chrom]},ns.ChordFactory.prototype.getChord=function(t){var h;for(void 0===t&&(h=this.chords[Math.floor(Math.random()*this.chords.length)]),i=0;i<this.chords.length;i++)t===this.chords[i].name&&(h=this.chords[i]);return h};
var ns=HealingHz.createNS("HealingHz.data");ns.Note=function(a,e,i){this.fileName=a,this.index=i,this.displayName=e};